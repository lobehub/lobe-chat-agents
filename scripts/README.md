# Scripts ç›®å½•ç»“æ„è¯´æ˜

æœ¬ç›®å½•åŒ…å«äº† Lobe Chat Agents é¡¹ç›®çš„æ‰€æœ‰è„šæœ¬å·¥å…·ï¼Œç»è¿‡é‡æ–°ç»„ç»‡å’Œä¼˜åŒ–ï¼Œä½¿åŠŸèƒ½æ›´åŠ æ¸…æ™°ï¼Œæ›´å®¹æ˜“ç»´æŠ¤ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
scripts/
â”œâ”€â”€ core/                    # æ ¸å¿ƒé…ç½®å’Œæ¨¡å‹
â”‚   â”œâ”€â”€ constants.ts         # é¡¹ç›®å¸¸é‡é…ç½®
â”‚   â””â”€â”€ model.ts            # AI æ¨¡å‹é…ç½®
â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ file.ts             # æ–‡ä»¶æ“ä½œå·¥å…·
â”‚   â”œâ”€â”€ common.ts           # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ logger.ts           # è‡ªå®šä¹‰æ—¥å¿—ç³»ç»Ÿ
â”œâ”€â”€ parsers/                 # è§£æå™¨æ¨¡å—
â”‚   â””â”€â”€ agent-parser.ts     # Agent æ–‡ä»¶è§£æå™¨
â”œâ”€â”€ processors/              # å¤„ç†å™¨æ¨¡å—
â”‚   â”œâ”€â”€ category-processor.ts # åˆ†ç±»å¤„ç†å™¨
â”‚   â””â”€â”€ i18n-processor.ts   # å›½é™…åŒ–å¤„ç†å™¨
â”œâ”€â”€ validators/              # éªŒè¯å™¨æ¨¡å—
â”‚   â”œâ”€â”€ agent-validator.ts  # Agent éªŒè¯å™¨
â”‚   â””â”€â”€ language-validator.ts # è¯­è¨€éªŒè¯å™¨
â”œâ”€â”€ builders/                # æ„å»ºå™¨æ¨¡å—
â”‚   â””â”€â”€ agent-builder.ts    # Agent æ„å»ºå™¨
â”œâ”€â”€ formatters/              # æ ¼å¼åŒ–å™¨æ¨¡å—
â”‚   â””â”€â”€ agent-formatter.ts  # Agent æ ¼å¼åŒ–å™¨
â”œâ”€â”€ commands/                # å‘½ä»¤è¡Œå·¥å…·
â”‚   â”œâ”€â”€ build.ts            # æ„å»ºå‘½ä»¤
â”‚   â”œâ”€â”€ format.ts           # æ ¼å¼åŒ–å‘½ä»¤
â”‚   â”œâ”€â”€ test.ts             # æµ‹è¯•å‘½ä»¤
â”‚   â”œâ”€â”€ test-locale.ts      # æœ¬åœ°åŒ–æµ‹è¯•å‘½ä»¤
â”‚   â”œâ”€â”€ validate-language.ts # è¯­è¨€éªŒè¯å‘½ä»¤
â”‚   â”œâ”€â”€ update-awesome.ts   # æ›´æ–° README å‘½ä»¤
â”‚   â””â”€â”€ auto-submit.ts      # è‡ªåŠ¨æäº¤å‘½ä»¤
â”œâ”€â”€ schema/                  # æ•°æ®ç»“æ„å®šä¹‰
â”‚   â”œâ”€â”€ agentMeta.ts        # Agent å…ƒæ•°æ® Schema
â”‚   â””â”€â”€ llm.ts              # LLM ç›¸å…³ Schema
â””â”€â”€ README.md               # æœ¬è¯´æ˜æ–‡ä»¶
```

## ğŸš€ ä¸»è¦åŠŸèƒ½æ¨¡å—

### æ ¸å¿ƒæ¨¡å— (core/)

- **constants.ts**: åŒ…å«æ‰€æœ‰é¡¹ç›®å¸¸é‡ï¼Œå¦‚è·¯å¾„é…ç½®ã€åˆ†ç±»åˆ—è¡¨ã€ç¿»è¯‘å­—æ®µé€‰æ‹©å™¨ç­‰
- **model.ts**: OpenAI æ¨¡å‹é…ç½®å’Œåˆå§‹åŒ–

### å·¥å…·æ¨¡å— (utils/)

- **file.ts**: æ–‡ä»¶æ“ä½œç›¸å…³å·¥å…·å‡½æ•°ï¼Œå¦‚æ–‡ä»¶è¯»å†™ã€ç›®å½•ç®¡ç†ç­‰
- **common.ts**: é€šç”¨å·¥å…·å‡½æ•°ï¼Œå¦‚å­—ç¬¦ä¸²å¤„ç†ã€æ•°ç»„æ“ä½œç­‰
- **logger.ts**: è‡ªå®šä¹‰æ—¥å¿—ç³»ç»Ÿï¼Œæä¾›ç»“æ„åŒ–ã€å½©è‰²è¾“å‡ºï¼Œæ”¯æŒè¿›åº¦æ¡ã€ç»Ÿè®¡ä¿¡æ¯ç­‰

### è§£æå™¨æ¨¡å— (parsers/)

- **agent-parser.ts**: è§£æ Agent é…ç½®æ–‡ä»¶ï¼Œæå– IDã€è¯­è¨€ä»£ç å’Œå†…å®¹

### å¤„ç†å™¨æ¨¡å— (processors/)

- **category-processor.ts**: ä½¿ç”¨ AI è‡ªåŠ¨ä¸º Agent åˆ†é…åˆ†ç±»
- **i18n-processor.ts**: å¤„ç†å¤šè¯­è¨€ç¿»è¯‘ï¼Œæ”¯æŒ OpenAI API è°ƒç”¨

### éªŒè¯å™¨æ¨¡å— (validators/)

- **agent-validator.ts**: éªŒè¯ Agent é…ç½®æ ¼å¼å’Œæ•°æ®å®Œæ•´æ€§
- **language-validator.ts**: ä½¿ç”¨ @yutengjing/eld åº“éªŒè¯ç¿»è¯‘æ–‡ä»¶çš„è¯­è¨€å‡†ç¡®æ€§

### æ„å»ºå™¨æ¨¡å— (builders/)

- **agent-builder.ts**: æ„å»ºæ‰€æœ‰è¯­è¨€ç‰ˆæœ¬çš„ Agent æ–‡ä»¶å’Œç´¢å¼•

### æ ¼å¼åŒ–å™¨æ¨¡å— (formatters/)

- **agent-formatter.ts**: æ ¼å¼åŒ– Agent é…ç½®æ–‡ä»¶å¹¶ç”Ÿæˆå¤šè¯­è¨€ç‰ˆæœ¬ï¼Œæ”¯æŒå¢é‡ç¿»è¯‘æ£€æµ‹

### å‘½ä»¤è¡Œå·¥å…· (commands/)

- **build.ts**: æ„å»ºæ‰€æœ‰ Agent æ–‡ä»¶å’Œ Schema
- **format.ts**: æ ¼å¼åŒ– Agent é…ç½®æ–‡ä»¶ï¼Œè§¦å‘ç¿»è¯‘æµç¨‹
- **test.ts**: éªŒè¯ Agent é…ç½®æ–‡ä»¶æ ¼å¼
- **test-locale.ts**: éªŒè¯å¤šè¯­è¨€æ–‡ä»¶å®Œæ•´æ€§
- **validate-language.ts**: éªŒè¯ç¿»è¯‘æ–‡ä»¶è¯­è¨€å‡†ç¡®æ€§ï¼Œæ”¯æŒæ‰¹é‡éªŒè¯å’Œæ¸…ç†
- **update-awesome.ts**: æ›´æ–° README ä¸­çš„ Agent åˆ—è¡¨
- **auto-submit.ts**: è‡ªåŠ¨å¤„ç† GitHub Issue å¹¶åˆ›å»º PR

## ğŸ“‹ ä½¿ç”¨æ–¹æ³•

### æ„å»ºé¡¹ç›®

```bash
pnpm run build
```

### æ ¼å¼åŒ– Agent æ–‡ä»¶ï¼ˆåŒ…å«ç¿»è¯‘ï¼‰

```bash
pnpm run format
```

### è¿è¡Œæµ‹è¯•

```bash
pnpm run test
pnpm run test:locale # æµ‹è¯•å¤šè¯­è¨€æ–‡ä»¶
pnpm run type-check  # TypeScript ç±»å‹æ£€æŸ¥
```

### è¯­è¨€éªŒè¯

```bash
pnpm run validate:lang                    # éªŒè¯æ‰€æœ‰ç¿»è¯‘æ–‡ä»¶
pnpm run validate:lang --delete           # éªŒè¯å¹¶åˆ é™¤å¤±è´¥çš„æ–‡ä»¶
pnpm run validate:lang <file_path>        # éªŒè¯å•ä¸ªæ–‡ä»¶
pnpm run clean:lang                       # æ¸…ç†éªŒè¯å¤±è´¥çš„ç¿»è¯‘æ–‡ä»¶
```

### æ›´æ–° README

```bash
pnpm run update:awesome
```

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### ğŸ”„ å¢é‡ç¿»è¯‘ç³»ç»Ÿ

- **æ™ºèƒ½æ£€æµ‹**: è‡ªåŠ¨æ¯”è¾ƒæºæ–‡ä»¶ä¸ç°æœ‰ç¿»è¯‘ï¼Œä»…ç¿»è¯‘æ–°å¢æˆ–ä¿®æ”¹çš„å†…å®¹
- **å†…å®¹åˆå¹¶**: ä½¿ç”¨ lodash.merge å°†æ–°ç¿»è¯‘ä¸ç°æœ‰ç¿»è¯‘æ™ºèƒ½åˆå¹¶
- **æ€§èƒ½ä¼˜åŒ–**: é¿å…é‡å¤ç¿»è¯‘ï¼ŒèŠ‚çœ API è°ƒç”¨æˆæœ¬

### ğŸ›¡ï¸ è¯­è¨€éªŒè¯ç³»ç»Ÿ

- **è‡ªåŠ¨æ£€æµ‹**: ä½¿ç”¨ @yutengjing/eld åº“æ£€æµ‹ç¿»è¯‘æ–‡ä»¶çš„å®é™…è¯­è¨€
- **å‡†ç¡®æ€§éªŒè¯**: ç¡®ä¿ç¿»è¯‘ç»“æœä¸é¢„æœŸè¯­è¨€ä»£ç åŒ¹é…
- **æ‰¹é‡å¤„ç†**: æ”¯æŒæ‰¹é‡éªŒè¯å’Œè‡ªåŠ¨æ¸…ç†æ— æ•ˆæ–‡ä»¶
- **è¯¦ç»†æŠ¥å‘Š**: æä¾›ç½®ä¿¡åº¦ã€é—®é¢˜è¯¦æƒ…ç­‰è¯¦ç»†ä¿¡æ¯

### ğŸ“Š æ—¥å¿—ç³»ç»Ÿ

- **ç»“æ„åŒ–è¾“å‡º**: ç»Ÿä¸€çš„æ—¥å¿—æ ¼å¼ï¼Œæ”¯æŒä¸åŒçº§åˆ«å’Œé¢œè‰²
- **è¿›åº¦è¿½è¸ª**: å®æ—¶æ˜¾ç¤ºå¤„ç†è¿›åº¦å’Œç»Ÿè®¡ä¿¡æ¯
- **æ–‡ä»¶æ“ä½œæ—¥å¿—**: è¯¦ç»†è®°å½•æ–‡ä»¶è¯»å†™ã€åˆ›å»ºã€åˆ é™¤æ“ä½œ
- **ç¿»è¯‘æµç¨‹æ—¥å¿—**: ä¸“é—¨çš„ç¿»è¯‘è¿‡ç¨‹æ—¥å¿—è®°å½•

### ğŸ¯ ç¿»è¯‘å­—æ®µé…ç½®

æ”¯æŒçš„ç¿»è¯‘å­—æ®µï¼ˆåœ¨ constants.ts ä¸­é…ç½®ï¼‰ï¼š

- `meta.title` - Agent æ ‡é¢˜
- `meta.description` - Agent æè¿°
- `meta.tags` - æ ‡ç­¾
- `config.systemRole` - ç³»ç»Ÿè§’è‰²
- `summary` - æ‘˜è¦
- `examples` - ç¤ºä¾‹å¯¹è¯
- `config.openingMessage` - å¼€åœºæ¶ˆæ¯
- `config.openingQuestions` - å¼€åœºé—®é¢˜

## ğŸ”§ ä¼˜åŒ–ç‰¹æ€§

1. **æ¨¡å—åŒ–è®¾è®¡**: æŒ‰åŠŸèƒ½å°†ä»£ç åˆ†ç¦»åˆ°ä¸åŒæ¨¡å—ï¼Œæé«˜å¯ç»´æŠ¤æ€§
2. **ä¸­æ–‡æ³¨é‡Š**: ä¸ºæ‰€æœ‰å‡½æ•°å’Œé‡è¦ä»£ç æ·»åŠ äº†è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Š
3. **ç±»å‹å®‰å…¨**: ä½¿ç”¨ TypeScript æä¾›å®Œæ•´çš„ç±»å‹å®šä¹‰
4. **æ™ºèƒ½ç¿»è¯‘**: å¢é‡æ£€æµ‹é¿å…é‡å¤ç¿»è¯‘ï¼Œæé«˜æ•ˆç‡
5. **è´¨é‡ä¿è¯**: è‡ªåŠ¨è¯­è¨€éªŒè¯ç¡®ä¿ç¿»è¯‘è´¨é‡
6. **å¹¶å‘å¤„ç†**: ä½¿ç”¨ p-map è¿›è¡Œå¹¶å‘å¤„ç†ï¼Œæé«˜æ€§èƒ½
7. **æ¸…æ™°çš„èŒè´£åˆ†ç¦»**: æ¯ä¸ªæ¨¡å—éƒ½æœ‰æ˜ç¡®çš„èŒè´£èŒƒå›´
8. **ç»“æ„åŒ–æ—¥å¿—**: ç»Ÿä¸€çš„æ—¥å¿—ç³»ç»Ÿæä¾›æ›´å¥½çš„å¼€å‘ä½“éªŒ

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ ¸å¿ƒé€»è¾‘**: æ·»åŠ åˆ° `processors/`ã€`validators/` æˆ– `builders/` ç›®å½•
2. **å·¥å…·å‡½æ•°**: æ·»åŠ åˆ° `utils/file.ts` æˆ– `utils/common.ts`
3. **å‘½ä»¤è¡Œå·¥å…·**: åœ¨ `commands/` ç›®å½•åˆ›å»ºæ–°å‘½ä»¤
4. **ç±»å‹å®šä¹‰**: åœ¨ `schema/` ç›®å½•æ›´æ–°ç±»å‹å®šä¹‰

### ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿ

```typescript
import { Logger } from '../utils/logger';

// åŸºæœ¬æ—¥å¿—
Logger.info('å¤„ç†æ–‡ä»¶', fileName);
Logger.success('æ“ä½œå®Œæˆ', target, details);
Logger.warn('è­¦å‘Šä¿¡æ¯', reason);
Logger.error('é”™è¯¯ä¿¡æ¯', error);

// æµç¨‹æ—¥å¿—
Logger.start('å¼€å§‹æ“ä½œ', target);
Logger.split('åˆ†éš”çº¿æ ‡é¢˜');

// æ–‡ä»¶æ“ä½œ
Logger.file('read', filePath, 'success');
Logger.translate(agentId, 'zh-CN', 'en-US', 'success');

// ç»Ÿè®¡ä¿¡æ¯
Logger.stats({
  æ€»æ–‡ä»¶æ•°: totalCount,
  æˆåŠŸæ•°é‡: successCount,
});
```

### è°ƒè¯•æŠ€å·§

```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
DEBUG=true pnpm run validate:lang

# ç±»å‹æ£€æŸ¥
pnpm run type-check

# å•ä¸ªæ–‡ä»¶æµ‹è¯•
pnpm run validate:lang path/to/file.json
```
